<!-- views/index.erb -->
<% if @assets.any? %>
  <h2> </h2>
  <p> This is where the films go:</p>
  <div class="video-container">
    <% @assets.each do |asset| %>
    <div class="video_asset">
      <script src="https://cdn.jsdelivr.net/npm/@mux/mux-player"></script>
        <mux-player
            playback-id= <%= asset.playback_id%>
            metadata-video-title="Placeholder (optional)"
            metadata-viewer-user-id="Placeholder (optional)"
            primary-color="#d38a8a"
            accent-color="#d38a8a"
        ></mux-player>

        <div class="asset_info">
          <div class="asset_title">
          <b>Title:</b> <%= asset.title%>
          </div>
          <div class="asset_description">
          <b>Description:</b> <%= asset.description%>
          </div>
          <div class="asset_year">
          <b>Year:</b> <%= asset.year%>
          </div>
          <div class="asset_notes">
          <b>Notes:</b> <%= asset.notes%>
          </div>
          <div class="divider"></div>
          <div><b>The playback ID is:</b> <%= asset.playback_id%> </div>
          <div><b> The asset ID is:</b> <%= asset.asset_id%> </div>
          <div><b>The database ID is:</b> <%= asset.database_id%> </div>
        </div>

        <!-- Edit button -->
        <button class="edit-button" data-asset-id="<%= asset.asset_id %>">Edit</button>

        <!-- Edit form (hidden by default) -->
        <form id="editForm_<%= asset.asset_id %>" action="/update_asset_metadata/<%= asset.asset_id %>" method="POST" style="display: none;">
          <input type="hidden" name="_method" value="PUT">
          <label for="editTitle_<%= asset.asset_id %>">Title:</label>
          <input type="text" id="editTitle_<%= asset.asset_id %>" name="title" value="<%= asset.title %>">
          <label for="editDescription_<%= asset.asset_id %>">Description:</label>
          <textarea id="editDescription_<%= asset.asset_id %>" name="description"><%= asset.description %></textarea>
          <label for="editYear_<%= asset.asset_id %>">Year:</label>
          <input type="text" id="editYear_<%= asset.asset_id %>" name="year" value="<%= asset.year %>">
          <label for="editNotes_<%= asset.asset_id %>">Notes:</label>
          <textarea id="editNotes_<%= asset.asset_id %>" name="notes"><%= asset.notes %></textarea>
          <button type="submit">Save</button>
        </form>
        <!-- Form for deleting the asset -->
        <form action="/assets/<%= asset.asset_id %>" method="POST" class="delete-form">
          <input type="hidden" name="_method" value="DELETE">
          <button type="submit">Delete</button>
        </form>
    </div>
    <% end %>
<% else %>
  <p>No films available at the moment...</p>
<% end %>

<!-- Script for hiding and revealing EDIT form -->
<script>
  document.querySelectorAll('.edit-button').forEach(function(button) {
    button.addEventListener('click', function() {
      var assetId = this.getAttribute('data-asset-id');
      var editForm = document.getElementById('editForm_' + assetId);
      editForm.style.display = 'block';
      this.style.display = 'none';
    });
  });
</script>
</div>
